# 명세 기반 테스트

이번 장에서는 명세 기반 테스트란 무엇인가? 에 대해서 다룬다.

여기서 명세란 무엇일까?

- 유저 스토리나 UML의 유스 케이스 같은 프로그램 요구사항을 테스트의 입력으로 사용하는 것이다.

명세 기반의 테스트는 개발이 완료되고 난 이후에 버그를 찾아야 할 때 적합한 방식이다.

이 책에서는 apache commons의 substringbetween 메소드를 활용해 명시 기반 테스트가 무엇인지 설명합니다.

명시 기반 테스트를 하기위한 절차는 다음과 같다고 설명합니다.

```
1단계: 요구사항과 입출력에 대해 이해하기.
2단계: 여러 입력값에 대해 프로그램이 수행하는 바를 탐색하기.
3단계: 테스트 가능한 입출력과 구획을 탐색하기.
4단계: 경계 분석하기.
5단계: 테스트 케이스 고안하기.
6단계: 테스트 케이스 자동화하기.
7단계: 창의성과 경험을 발휘해서 테스트 스위트를 강화하기.
```

각 단계를 substringbetween 메서드를 활용해 예제로서 설명합니다. 각 단계를 간단히 살펴보면



**1단계: 요구사항과 입출력에 대해 이해하기.**

먼저 substringBetween() 의 시그니처를 이해하는 것에서 시작합니다. 

어떤 입력값과 결과값이 나올 수 있는지, 그리고 substringBetween() 메소드를 통해 원하고자 하는 것이 무엇인지 탐구합니다.



**2단계: 여러 입력값에 대해 프로그램이 수행하는 바를 탐색하기.**

이 단계에서는 substringBetween() 에 대해서 느낌에 따라 한번 테스트 케이스를 작성해보는 것입니다. 이 메소드가 어떻게 동작될 것이라고 예측하면서 일단 작성해봅니다.



**3단계: 테스트 가능한 입출력과 구획을 탐색하기.**

조금더 체계를 갖고, 입출력과 구획을 탐색합니다. 이때 입력할 수 있는 입력파라미터로 open, close 매개변수가 있을 테고, 전체 문자열을 넣는 매개변수도 있을 것이다.

다음과 같은 절차로 탐색해볼 수 있다.

1. 각각의 입력에 대해: '내가 전달하는 입력이 어떤 부류에 해당하는가?'
2. 각 입력과 다른 입력의 조합에 대해: 'open 태그와 close 태그 사이에 어떤 조합을 만들 수 있을까?'
3. 이 프로그램에서 기대하는 여러 분류의 출력에 대해: '배열을 리턴하는가? 빈 배열을 리턴할 수 있을까? 널을 리턴할 수 있을까'

그러면, str, open, close 매개변수에 대한 조합을 찾을 수 있다.



**4단계: 경계 분석하기.**

 경계라 함은 입력하는 도메인의 경계를 의미한다. 예를 들어 '~보다 크거나 같은(>=)' 대신 '보다 큰(>)' 을 쓰는 실수를 저지른다. 

구획을 설계할 때 한 구획은 다른 구획과 **가까운 경계**를 지닌다. 그러므로, 탐구시 경계를 발견할 때마다 입력을 한 경계에서 다른 경계로 이동시키며 프로그램에 어떤 일이 일어나는지 테스트 해야 하는데, 하나는 경계 위에 있는 **접점(on Point)** 테스트이고, 다른 하나는 접점에 속해 있지 않는 구획에 있으면서 경계에 가장 가까운 점은 **거점(off Point)**



**5단계: 테스트 케이스 고안하기.**

앞에 3,4 단계를 통해 어떤 테스트 케이스를 작성할지 분석을 했었다. 모든 조합을 찾으면 약 320개 정도가 되는데, 이는 그다지 노력대비 성과가 크지 않을 것입니다. 어떻게 해야될까?

이떄는 구획을 어떻게 조합할지 실용적으로 결정해야 하는데, 테스트 횟수를 줄이기 위한 첫번째 방법은 예외적인 경우는 한 번만 수행하고 조합하지 않는것 대표적인 사례로 Null 문자열이나, 빈문자열, 길이가 1인 문자열 등이 될 수 있다.

 경계와 함께 실용적인 테스트를 살펴보면 다음과 같다

- 예외케이스
- str 길이가 1인 경우
- str길이가 > 1 open길이 = 1, close 길이 = 1
- str 길이 > 1, open 길이 > 1, close 길이 > 1
- 경계를 위한 테스트

**6단계: 테스트 케이스 자동화하기.**

 5단계에서 고려한 테스트 케이스를 JUnit 등과 같은 도구로 자동화하는 것이다.



**7단계: 창의성과 경험을 발휘해서 테스트 스위트를 강화하기.**

자동화된 테스트 케이스에서 파라미터라이즈 테스트와 같이 좀더 반복을 없앨 수 있는 방법을 찾아 테스트 케이스 코드를 강화하자.



--

## 현업에서의 명세 테스트

이 책에서 말하는 현업에서는 어떤 실용적인 팁이 있는지 소개한다.

- 프로세스는 연속적이 아니라 반복적이어야 한다.
- 명세 테스트는 어느 정도로 수행해야 하는가?
- 구획인가, 경계인가? 그것은 중요하지 않다!
- 접점과 거점으로도 충분하지만 내점과 외점도 얼마든지 추가하자
- 이해를 높이기 위해 입력을 변경해서 사용하자
- 조합의 수가 폭발적으로 증가한다면 실용적이어야 한다.
- 무엇을 입력할지 모르겠다면 간단한 입력으로 넣어보자
- 관심 없는 입력에 대해 합리적인 값을 선택하자
- 널과 예외 케이스는 의미가 있을 때만 사용하자
- 테스트가 동일한 스켈레톤을 갖는 경우 매개변수화 테스트 사용
- 요구사항은 잘게 쪼갤 수 있다
- 이것은 클래스와 상태에 어떻게 동작하는가?
- 경험과 창의성의 역할

