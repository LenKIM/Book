# 더 심층적인 통찰력을 향한 리팩토링

핵심사항을 통합해보는 것이 도움이 될 것

1. 활동의 근거지를 도메인을 삼는다.
2. 현상과 사물을 다른 방식으로 바라보도록 노력한다.
3. 도메인 전문가와 지속적으로 대화한다.

도메인에 대한 통찰력을 추구하다 보면 리팩터링 과정을 위한 더욱 폭넓은 컨텍스트가 만들어진다.



### 시작

 전통적인 관점의 리팩터링과는 차이가 있지만 도메인 전문가가 이해하지 못하는 언어를 사용해서 모델이 작성돼 있거나 새로운 요구사항을 자연스럽게 수용할 수 없다면 코드가 깔끔해 보여도 이와 유사한 느낌을 받을 수 있다. 리팩터링은 도메인을 더욱 심층적으로 이해한 개발자가 더 명쾌하고 유용한 모델로 개선할 수 있는 여지를 발견하는 과정에서 얻게 된 학습의 결과다.

### 조사팀

- 코드를 만족스럽게 못하게 만드는 원인은 무엇이건 간에, 다음 과정은 모델을 좀더 명확하고 자연스럽게 의사소통할 수 있게 만들어줄 개선안을 조사하는 것.
- 명백하면서도 짧은 시간 안에 완료할 수 있을 정도의 적은 변경만으로 코드를 개선할 수 있다. 이 경우 변경 과정은 전통적인 리팩터링 과정과 비슷하다. 브래인스토밍하고, 돌아와 코드로 옮긴다. 이렇게 할 수 있는 비결은 3가지있다.
  - 자기 결정
  - 범위와 휴식
  - 유비쿼터스 언어 사용

### 선행 기술

 항상 바퀴를 다시 발명할 필요는 없다. 누락된 개념을 발견하고 더 나은 모델을 만들기 위한 브레인스토밍 과정은 가능한 모든 출처로부터 아이디어를 흡수하고, 흡수한 아이더와 지엽적인 지식을 결합하며, 현재 직면한 문제의 해답을 찾는 탐구 과정을 지속할 수 있게 만든다.



### 개발자를 위한 설계

- 소프트웨어는 사용자만을 위한 것이 아니다. 개발자를 위한 것이기도 하다. 개발자들은 작성된 코드를 시스템의 다른 부분과 통합해야 한다. 반복적인 프로세스를 거쳐 개발자는 몇 번이고 반복적으로 코드를 수정한다. 



-  유연한 설계는 설계의 의도를 전달한다. 유연한 설계는 실행 중인 코드의 영향을 쉽게 예측할 수 있게 만들어주므로 설계 변경의 결과 역시 쉽게 예상할 수 있다.

- 유연한 설계는 사용자에게 가장 핵심적인 부분만을 세밀하게 표현하는 심층적인 도메인 모델에 기반을 둔다. 이것은 변경이 가장 빈번하게 발생하는 부분은 유연하게 유지하고 그 밖의 자주 변경되지 않는 부분은 단순하게 만드는 데 도움이 된다.

### 타이밍

 **변경을 완벽하게 정당화할 수 있을 때까지 기다린다면 지나치게 오랫동안 기다린 셈이다.**

언제 리팩토링을 해야 하는가?

- 현재 팀에서 도메인을 이해하고 있는 바가 설계에 표현돼 있지 않은 경우
- 중요한 개념이 설계상에 암시적으로 표현돼 있는 경우(그리고 개념을 명확하게 표현할 수 있는 방법이 보이는 경우)
- 설계상의 중요한 부분을 더욱 유연하게 만들 기회가 보이는 경우

### 위기를 기회로

단속 평형론? 진화의 확장된 관점에서는 오랜 기간 동안의 점진적인 변화나 안정성은 상대적으로 짧은 기간의 폭발적이면서 신속한 변화로 중단된다. 그 후 종은 새로운 평형 상태에 안착한다. 소프트웨어 개발에는 진화에는 없는 어떤 의도적인 방향성이 있지만(어떤 프로젝트에서는 분명하게 드러나지 않기도 하지만) 그럼에도 소프트웨어 개발 역시 이와 유사한 종류의 리듬을 따른다.

