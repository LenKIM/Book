# 마이크로서비스란 무엇일까?

: 비지니스 도메인을 중심으로 모델링된 독립적으로 배포 가능한 서비스

- 마이크로서비스는 네트워크를 통해 서로 통신한다.
- 서비스 지향 아키텍쳐의 한 유형이다.
- 기술에 중립적



## 독립적인 배포 가능성

**위에서 말한 독립적인 배포 가능성은 무엇을 의미하는가?**

- 다른 서비스를 활용하지 않고서 마이크로서비스에 변경을 가하는 방식으로 서비스 환경에 배포할 수 있다

=> **마이크로서비스의 독립적인 배포 가능성 개념을 반드시 포용하라!**



독립적인 배포를 위해서는, 서비스가 **느슨하게 결합되어 있음(loosely coupled)** 을 보증할 필요가 있다.

**즉, 다른 서비스를 변경하지 않고도 특정 서비스를 변경할 수 있는 능력을 갖쳐야 한다.**



## 비지니스 도메인을 중심으로 하는 모델링

프로세스 경계를 넘어서는 변경에는 비용이 많이 든다. 기능을 출시하기 위해 두 서비스를 변경하고 이 두 변경사항의 배포를 조정할 필요가 있는 경우, 단일 서비스(또는 마찬가지로 모놀리스)내에서 동일한 변경을 수행하는 것보다 더 많은 작업이 필요하다. 따라서, cross-service 변경을 최소로 줄이게끔 보증하는 방법을 찾고자 한다.



--



### 3계층 아키텍처의 단점은 무엇인가?

> 시스템을 설계하는 모든 조직은 --- 불가피하게 조직의 커뮤니케이션 구조를 본떠 시스템 구조를 만들어 낼 것이다.
>
> ​																								- 멜빈 콘웨이 '위원회는 어떻게 발명할까?' 발표 중에서



[3계층 아키텍쳐 그림]



3계층 아키텍처는 기술 관점에서 응집력이 높지만, 비즈니스 관점에서는 응집력이 낮다. 쉽게 변경할 수 있게 만들려면 코드를 그룹화하는 방식을 바꿔야 한다. **즉 기술보다는 비즈니스 기능의 응집력을 선택할 필요가 있다.**  각 서비스는 이런 세 계층의 혼합을 포함하는 상황으로 끝날 수도 그렇지 않을 수도 있지만 이런 서비스는 로컬 서비스 구현 문제일 뿐이다.



## 데이터 소유권 문제

`마이크로서비스는 데이터베이스를 공유해서는 안 된다?` 라는 생각 때문에 매우 곤란해 하는 사람들이 있다. 어떤 서비스에서 다른 서비스가 보유한 데이터에 접근하고 싶다면 데이터를 보유한 서비스를 찾아서 해당 데이터를 요청해야 마땅하다. 해당 서비스는 외부에 무엇을 공유하고 무엇을 숨길지를 결정할 수 있다. 

또한, 임의의 이유로 변경될 수 있는 내부 구현 세부사항으로부터 좀 더 안정적인 공개 계약으로 서비스를 매핑함으로써, 안정적인 서비스 인터페이스를 보장한다.

독립적인 배포 가능성(independent deployablity) 을 원한다면 서비스 간에 안정적인 인터페이스가 필수다.





결론

배포의 독립적인 특성으로 인해 시스템의 확장성과 견고성을 개선할 수 있으며, 다양한 기술을 짜맞출 수 있다. 병렬로 개발 가능하면서, 서로 방해받지 않고 각자 문제 해결에 몰입할 수 있다. 또한 갭라자가 시스템에 자신이 맡은 부분에만 전념할 수 있으므로 시스템의 한 부분에만 집중할 수 있다.



그럼 마이크로서비스는 장점만 있는가? 그건 아니다. SOA 가 나온 배경은 컴퓨터가 저렴해져 널리 보급되면서, 서비스 지양 아키텍처는 거대한 메인 프레임 하나에 시스템을 배포하는 대신, 여러 대의 저렴한 컴퓨터를 사용하는 방식으로 가능해졌다. SOA는 여러 컴퓨터에 나뉘어 동작하는 애플리케이션을 가장 잘 구축하는 방법을 찾으려는 시도에서 등장했다.



이 과정에서 주 장애물은 바로 네트워크이다. 네트워크 즉 컴퓨터 간의 통신은 즉각적이지 않다. 이는 특히 로컬 프로세스 내 작업에서 볼 수 있는 대기 시간과  비교해 휠씬 더 긴 대기 시간을 걱정해야 한다는 의미이다. 이런 장애물은 트랜잭션 같은 단일 프로세스 모놀리스로 해결 가능한 비교적 단순한 활동은 휠씬 더 어려워진다. 이는 실제로도 매우 어렵기 떄문에, 시스템이 복잡해지면 다른 종류의 기술을 도입하는 대가로 트랜잭션과 안정성을 포기해야 한다.



> 우리는 대가를 치고 마이크로서비스 선택권을 구매한다. 
>
> ​																- 제임스 루이스



